Installation Debian 8 in VM

/etc/ssh/sshd_config:
UseDNS no
PermitRootLogin yes

/etc/systemd/logind.conf:
HandleLidSwitch=ignore
HandleLidSwitchDocked=ignore

apt-get purge exim4 rpcbind portmap at avahi-daemon

apt-get install dnsutils nmap tcpdump traceroute chkconfig curl git less screen bsd-mailx vim ntp ntpdate

apt-get install apt-transport-https ca-certificates
apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
echo "deb https://apt.dockerproject.org/repo debian-jessie main" > /etc/apt/sources.list.d/docker.list
apt-get update
apt-get install docker-engine arping

apt-get autoremove
apt-get clean

systemctl enable docker

apt-get install bridge-utils

/etc/network/interfaces:
=========
source /etc/network/interfaces.d/*

auto lo br0

allow-hotplug th0
iface eth0 inet manual

iface br0 inet static
        bridge_ports eth0
        bridge_stp off       # disable Spanning Tree Protocol
        bridge_waitport 0    # no delay before a port becomes available
        bridge_fd 0

        address 10.20.0.X
        netmask 255.255.0.0
        network 10.20.0.0
        broadcast 10.20.255.255
        gateway 10.20.0.1
        dns-nameservers 10.20.8.1
=========


cd /root
git clone https://github.com/pecharmin/dnssec-workshop.git


/etc/default/docker:
DOCKER_OPTS="--log-level=info --iptables=false --ip-forward=true -b=br0 --fixed-cidr=10.20.<NETID>.1/24"


/etc/systemd/system/docker.service:
[Service]
EnvironmentFile=-/etc/default/docker
ExecStart=/usr/bin/docker daemon -p /run/docker.pid $DOCKER_OPTS


~/.bashrc
=========

alias d=docker

ds() {
	CID=ns$1
	docker run --detach --net=bridge --dns=127.0.0.1 --hostname=$CID --name=$CID dnssec-bind || echo $CID failed
	echo -n "$CID: " ; docker inspect $(docker ps | grep $CID | cut -d' ' -f1) | grep '"IPAddress' | awk '{print $2}' | tr -d [\",] | uniq
}

dl() {
	docker ps -a | grep -v CONTAINER | awk '{print $1,$NF}' | while read cid name ; do echo -n "$name: " ; docker inspect $cid | grep '"IPAddress' | awk '{print $2}' | tr -d [\",] | uniq ; done | sort
}
=========



docker pull dnssecworkshop/dnssec-bind
docker pull dnssecworkshop/dnssec-rootns-a
docker pull dnssecworkshop/dnssec-rootns-b
docker pull dnssecworkshop/dnssec-tldns-a
docker pull dnssecworkshop/dnssec-tldns-b
docker pull dnssecworkshop/dnssec-sldns-a
docker pull dnssecworkshop/dnssec-sldns-b
docker pull dnssecworkshop/dnssec-resolver
docker pull dnssecworkshop/dnssec-attendee

cd /root
wget https://raw.githubusercontent.com/jpetazzo/pipework/master/pipework
chmod 755 pipework

cat <<EOF > /root/dnssec-hosts
dnssec-rootns-a 10.20.1.1
dnssec-rootns-b 10.20.1.2
dnssec-tldns-a 10.20.2.1
dnssec-tldns-b 10.20.2.2
dnssec-sldns-a 10.20.4.1
dnssec-sldns-b 10.20.4.2
dnssec-resolver 10.20.8.1
EOF

" | while read name ip
do
  CID=$(docker run --detach --net=bridge --dns=127.0.0.1 \
        --hostname=$name --name=$name \
        dnssecworkshop/$name) || continue

	/root/pipework br0 $CID $ip/16
done


/* vim: set syntax=markdown tabstop=2 expandtab: */
